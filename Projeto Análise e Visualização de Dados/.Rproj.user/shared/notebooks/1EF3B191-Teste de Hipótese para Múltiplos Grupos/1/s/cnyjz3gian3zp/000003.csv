"0","pwpm
"
"1","function (emm, by, reverse = FALSE, pvals = TRUE, means = TRUE, 
"
"1","    diffs = TRUE, flip = FALSE, digits, ...) 
"
"1","{
"
"1","    emm = .chk.list(emm, ...)
"
"1","    if (missing(by)) 
"
"1","        by = emm@misc$by.vars
"
"1","    emm = update(emm, by = by)
"
"1","    pri = paste(emm@misc$pri.vars, collapse = "":"")
"
"1","    mns = confint(emm, frequentist = TRUE, ...)
"
"1","    mns$lbls = do.call(paste, c(unname(mns[attr(mns, ""pri.vars"")]), 
"
"1","        sep = get_emm_option(""sep"")))
"
"1","    estName = attr(mns, ""estName"")
"
"1","    prs = test(pairs(emm, reverse = reverse, frequentist = TRUE, 
"
"1","        ...), ...)
"
"1","    diffName = attr(prs, ""estName"")
"
"1","    null.hyp = ""0""
"
"1","    if (!reverse) 
"
"1","        trifcn = lower.tri
"
"1","    else {
"
"1","        flip = !flip
"
"1","        trifcn = upper.tri
"
"1","    }
"
"1","    if (!is.null(prs$null)) {
"
"1","        null.hyp = as.character(signif(unique(prs$null), digits = 5))
"
"1","        if (length(null.hyp) > 1) 
"
"1","            null.hyp = ""(various values)""
"
"1","    }
"
"1","    mby = .find.by.rows(mns, by)
"
"1","    pby = .find.by.rows(prs, by)
"
"1","    if (opt.dig <- missing(digits)) {
"
"1","        tmp = mns[[estName]] + mns[[""SE""]] * cbind(rep(-2, nrow(mns)), 
"
"1","            0, 2)
"
"1","        digits = max(apply(tmp, 1, .opt.dig))
"
"1","        opt.dig = TRUE
"
"1","    }
"
"1","    result = lapply(seq_along(mby), function(i) {
"
"1","        if (opt.dig) {
"
"1","            pv = prs$p.value[pby[[i]]]
"
"1","            fpv = sprintf(""%6.4f"", pv)
"
"1","            fpv[pv < 1e-04] = ""<.0001""
"
"1","        }
"
"1","        else fpv = format(prs$p.value[pby[[i]]], digits = digits)
"
"1","        fmn = format(mns[mby[[i]], estName], digits = digits)
"
"1","        fdiff = format(prs[pby[[i]], diffName], digits = digits)
"
"1","        lbls = mns$lbls[mby[[i]]]
"
"1","        n = length(lbls)
"
"1","        mat = matrix("""", nrow = n, ncol = n, dimnames = list(lbls, 
"
"1","            lbls))
"
"1","        if (pvals) {
"
"1","            mat[trifcn(mat)] = fpv
"
"1","            mat = t(mat)
"
"1","        }
"
"1","        if (diffs) 
"
"1","            mat[trifcn(mat)] = fdiff
"
"1","        if (means) 
"
"1","            diag(mat) = fmn
"
"1","        else {
"
"1","            idx = seq_len(n - 1)
"
"1","            if (pvals && !diffs) 
"
"1","                mat = mat[idx, 1 + idx]
"
"1","            if (!pvals && diffs) 
"
"1","                mat = mat[1 + idx, idx]
"
"1","        }
"
"1","        if (flip) 
"
"1","            t(mat)
"
"1","        else mat
"
"1","    })
"
"1","    if (reverse) 
"
"1","        flip = !flip
"
"1","    names(result) = paste(paste(by, collapse = "", ""), ""="", names(mby))
"
"1","    if (length(result) == 1) 
"
"1","        result = result[[1]]
"
"1","    class(result) = c(""pwpm"", ""list"")
"
"1","    attr(result, ""parms"") = c(pvals = pvals, diffs = diffs, means = means, 
"
"1","        pri = pri, estName = estName, diffName = diffName, reverse = reverse, 
"
"1","        flip = flip, type = attr(mns, ""type""), adjust = attr(prs, 
"
"1","            ""adjust""), side = attr(prs, ""side""), delta = attr(prs, 
"
"1","            ""delta""), null = null.hyp)
"
"1","    result
"
"1","}
"
"1","<bytecode: 0x000001df60e88560>
"
"1","<environment: namespace:emmeans>
"
